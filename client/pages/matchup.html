<div class="space-y-4">
    <h2 class="text-xl font-bold text-white">League Matchups</h2>
    <div id="matchups-table-container" class="overflow-x-auto">
        <!-- Table will be generated here by script -->
    </div>
</div>

<script>
    (async function() {
        const container = document.getElementById('matchups-table-container');
        try {
            const response = await fetch('/api/matchups');
            if (!response.ok) {
                const errorData = await response.json();
                throw new Error(errorData.error || 'Failed to fetch matchups');
            }
            const matchups = await response.json();

            if (matchups.length === 0) {
                container.innerHTML = '<p class="text-gray-400">No matchup data found for this league.</p>';
                return;
            }

            // Group matchups by week
            const matchupsByWeek = matchups.reduce((acc, matchup) => {
                const { week } = matchup;
                if (!acc[week]) {
                    acc[week] = [];
                }
                acc[week].push(matchup);
                return acc;
            }, {});

            let allWeeksHtml = '';
            for (const week in matchupsByWeek) {
                allWeeksHtml += `
                    <h3 class="text-lg font-semibold text-gray-200 mt-6 mb-2">Week ${week}</h3>
                    <div class="bg-gray-900 rounded-lg shadow">
                        <table class="min-w-full divide-y divide-gray-700">
                            <thead class="bg-gray-700/50">
                                <tr>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">
                                        Team 1
                                    </th>
                                    <th scope="col" class="px-6 py-3 text-left text-xs font-medium text-gray-300 uppercase tracking-wider">
                                        Team 2
                                    </th>
                                </tr>
                            </thead>
                            <tbody class="bg-gray-800 divide-y divide-gray-700">
                `;

                matchupsByWeek[week].forEach(match => {
                    allWeeksHtml += `
                        <tr class="hover:bg-gray-700/50">
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">${match.team1}</td>
                            <td class="px-6 py-4 whitespace-nowrap text-sm text-gray-300">${match.team2}</td>
                        </tr>
                    `;
                });

                allWeeksHtml += `
                            </tbody>
                        </table>
                    </div>
                `;
            }

            container.innerHTML = allWeeksHtml;

        } catch (error) {
            console.error('Error fetching or rendering matchups:', error);
            container.innerHTML = `<p class="text-red-400">Error: ${error.message}</p>`;
        }
    })();
</script>
